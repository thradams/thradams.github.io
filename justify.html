<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Text Justification</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    textarea {
      width: 100%;
      height: 120px;
      margin-bottom: 10px;
    }
    input {
      margin-bottom: 10px;
    }
    pre {
      padding: 10px;
      background: #f4f4f4;
      border: 1px solid #ddd;
      white-space: pre-wrap;
      font-family: monospace;
    }
  </style>
</head>
<body>
  <h1>Text Justification</h1>
  <textarea id="inputText" placeholder="Enter your text here..."></textarea><br>
  
  <label for="width">Line width:</label>
  <input type="number" id="width" value="73" min="10" max="100"><br>
  
  <label for="margin">Left margin (spaces):</label>
  <input type="number" id="margin" value="3" min="0" max="20"><br>
  
  <button onclick="justify()">Justify</button>
  
  <h2>Output:</h2>
  <pre id="output"></pre>

  <script>
    function justifyText(text, width, margin) {
      // Split only on empty lines (\n\n+), treat as paragraph breaks
      const paragraphs = text.split(/\n\s*\n/);
      const result = [];

      for (let para of paragraphs) {
        const words = para.split(/\s+/).filter(w => w.length > 0);
        let line = [];
        let lineLength = 0;

        for (let word of words) {
          if (lineLength + line.length + word.length > width) {
            result.push(justifyLine(line, lineLength, width, margin));
            line = [];
            lineLength = 0;
          }
          line.push(word);
          lineLength += word.length;
        }

        if (line.length > 0) {
          result.push(" ".repeat(margin) + line.join(" ").padEnd(width, " "));
        }

        // Add blank line between paragraphs
        result.push("");
      }

      // remove trailing blank line at end
      if (result[result.length - 1] === "") {
        result.pop();
      }

      return result.join("\n");
    }

    function justifyLine(words, lineLength, width, margin) {
      if (words.length === 1) {
        return " ".repeat(margin) + words[0].padEnd(width, " ");
      }

      const spacesNeeded = width - lineLength;
      const gaps = words.length - 1;
      const spacePerGap = Math.floor(spacesNeeded / gaps);
      let extraSpaces = spacesNeeded % gaps;

      return (
        " ".repeat(margin) +
        words
          .map((word, i) => {
            if (i === words.length - 1) return word;
            let spaces = " ".repeat(spacePerGap + (extraSpaces > 0 ? 1 : 0));
            if (extraSpaces > 0) extraSpaces--;
            return word + spaces;
          })
          .join("")
      );
    }

    function justify() {
      const text = document.getElementById("inputText").value;
      
      const margin = parseInt(document.getElementById("margin").value, 10);
      const width = parseInt(document.getElementById("width").value, 10) - margin;

      const output = justifyText(text, width, margin);
      document.getElementById("output").textContent = output;
    }
  </script>
</body>
</html>
